#!/usr/bin/env bash
#
# A helper script to watch and restart waybar on
# configuration changes
#
confdir="${XDG_CONFIG_HOME:-$HOME/.config}/waybar"
trap "killall waybar" EXIT
if ! command -v inotifywait >/dev/null; then
    echo "inotifywait is not installed, exiting"
    exit 1
fi

while [[ "$XDG_SESSION_TYPE" == "wayland" ]]; do
    inotifywait -e create,modify "$confdir"
    killall -SIGUSR2 waybar
done
